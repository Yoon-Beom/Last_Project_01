<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.shop">
	<resultMap type="shopVO" id="shopResult">
		<result property="shop_NO" column="shop_NO"/>
		<result property="member_NO" column="member_NO"/>
		<result property="shop_name" column="shop_name"/>
		<result property="shop_address" column="shop_address"/>
		<result property="shop_code" column="shop_code"/>
		<result property="shop_latitude" column="shop_latitude"/>
		<result property="shop_longitude" column="shop_longitude"/>
		<result property="shop_joinDate" column="shop_joinDate"/>
	</resultMap>
	
	<resultMap type="shopDetailVO" id="shopDetailResult">
		<result property="shopDetail_NO" column="shopDetail_NO"/>
		<result property="shop_NO" column="shop_NO"/>
		<result property="shop_ceo" column="shop_ceo"/>
		<result property="shop_phone" column="shop_phone"/>
		<result property="shop_open_time" column="shop_open_time"/>
		<result property="shop_close_time" column="shop_close_time"/>
		<result property="shop_introduce" column="shop_introduce"/>
		<result property="shop_starScore" column="shop_starScore"/>
		<result property="shop_imageMain" column="shop_imageMain"/>
		<result property="shop_imageSub" column="shop_imageSub"/>
		<result property="shop_heartScore" column="shop_heartScore"/>
		<result property="shop_reserveScore" column="shop_reserveScore"/>
		<result property="shop_Detail_joinDate" column="shop_Detail_joinDate"/>
	</resultMap>
	
<!-- 	<resultMap type="joinShopVO" id="ShopJoinMap">
		<collection property="shopVO" resultMap="shopResult" />
		<collection property="shopDetailVO" resultMap="shopDetailResult" />
	</resultMap> -->
	
 	<select id="selectAllShopList" resultMap="shopResult"> 
      <![CDATA[
         select * from t_shop order by shop_joinDate desc
      ]]>
    </select>
    <!--     SELECT t.shop_name, t.shop_code, t.shop_address 
         FROM t_shop t 
         WHERE t.member_NO= #{member_NO} -->
 	<select id="selectShopList" resultType="HashMap" parameterType="int"> 
      <![CDATA[
          select s.shop_NO, s.member_NO, s.shop_name, s.shop_address, s.shop_code,
           d.shopDetail_NO, d.shop_NO, d.shop_ceo, d.shop_phone, d.shop_open_time,
       d.shop_close_time, d.shop_introduce, d.shop_starScore, d.shop_imageMain,
       d.shop_imageSub, d.shop_heartScore, d.shop_reserveScore,d.shopDetail_joinDate
       from t_shopDetail d inner join t_shop s
       on d.shop_NO = s.shop_NO
        
       inner join t_member m on s.member_NO = m.member_NO
       where m.member_NO = #{member_NO}
      ]]>
    </select>
   		
	<insert id="insertShop" parameterType="shopVO">
		<![CDATA[
			insert into t_shop(shop_NO, member_NO, shop_name, 
			    shop_address, shop_code, 
			    shop_latitude, shop_longitude)
			    values(seq_shop.nextval, #{member_NO}, #{shop_name},
			    #{shop_address}, #{shop_code},
			    #{shop_latitude}, #{shop_longitude})
		]]>
	</insert>
	
		<insert id="insertShopDetail" parameterType="shopDetailVO">
		<![CDATA[
			insert into t_shopDetail(shopDetail_NO, shop_NO, shop_ceo,
				shop_phone, shop_open_time, shop_close_time)
				values(seq_shopDetail.nextval, #{shop_NO}, #{shop_ceo},
			    #{shop_phone}, #{shop_open_time}, #{shop_close_time})
		]]>
	</insert>
	
	<!-- 		<insert id="insertShopDetail" parameterType="shopDetailVO">
		<![CDATA[
			insert into t_shopDetail(shopDetail_NO, shop_NO, shop_ceo,
				shop_phone, shop_open_time, shop_close_time, shop_introduce,
				shop_starScore, shop_imageMain, shop_imageSub, shop_heartScore,
				shop_reserveScore)
				values(seq_shopDetail.nextval, #{shop_NO}, #{shop_ceo},
			    #{shop_phone}, #{shop_open_time}, #{shop_close_time},
			    #{shop_introduce}, #{shop_starScore}, #{shop_imageMain},
			    #{shop_imageSub}, #{shop_heartScore}, #{shop_reserveScore})
		]]>
	</insert> -->
	<delete id="deleteShop" parameterType="String">
		<![CDATA[
			delete from t_shop where shop_name=#{shop_name}
		]]>
	</delete>
	
	<select id="selectShop_NO" resultType="int" parameterType="String">
		<![CDATA[
			select shop_NO from t_shop where member_NO=#{member_NO}
		]]>
	</select>
</mapper>
